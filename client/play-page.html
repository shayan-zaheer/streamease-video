<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>StreamEase-Jumanji</title>
		<!-- link css -->
		<link rel="stylesheet" href="css/style.css" />
		<!-- favicon -->
		<link rel="shortcut icon" href="img/favicon.png" type="image/x-icon" />
		<!-- box icons -->
		<link
			href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
			rel="stylesheet"
		/>
	</head>
	<body>
		<!-- header -->
		<header>
			<!-- nav -->
			<div class="nav container">
				<!-- logo -->
				<a href="index.html" class="logo">Stream<span>Ease</span></a>

				<!-- search box -->
				<div class="search-box">
					<input
						type="search"
						name=""
						id="search-input"
						placeholder="Search movie"
					/>
					<i class="bx bx-search"></i>
				</div>

				<!-- user -->
				<a href="#" class="user">
					<img src="img/user.jpg" alt="" class="user-img" />
				</a>

				<!-- nav-bar -->
				<div class="navbar">
					<a href="index.html" class="nav-link nav-active">
						<i class="bx bx-home"></i>
						<span class="nav-link-title">Home</span>
					</a>
					<a href="#home" class="nav-link">
						<i class="bx bxs-hot"></i>
						<span class="nav-link-title">Trending</span>
					</a>
					<a href="#home" class="nav-link">
						<i class="bx bx-compass"></i>
						<span class="nav-link-title">Explore</span>
					</a>
					<a href="#home" class="nav-link">
						<i class="bx bx-tv"></i>
						<span class="nav-link-title">Movies</span>
					</a>
					<a href="#home" class="nav-link">
						<i class="bx bx-heart"></i>
						<span class="nav-link-title">Favorite</span>
					</a>
				</div>
			</div>
		</header>

		<!-- play movie container -->
		<div class="play-container container">
			<!-- play image -->
		</div>

		<!-- About -->
		<div class="about-movie container">

        </div>

		<!-- copyright -->
		<footer class="copyright">
            <div>
                <a href="#" id="linkedin-link"><i class='bx bxl-linkedin'></i></a>
            </div>
        </footer>

		<!-- link swiper js -->
		<script src="js/swiper-bundle.min.js"></script>

		<!-- link js -->
		<script src="js/main.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", (event) => {
				const urlParams = new URLSearchParams(window.location.search);
				const movieId = urlParams.get("id");

				if(movieId){
					fetch(`http://localhost:8000/movies/${movieId}`)
						.then((response) => response.json())
						.then((data) => {
							console.log(data.movie);
							const movieDetails =
								document.querySelector(".play-container");
							movieDetails.innerHTML = `
                            <img src=${data.movie.h_poster} alt="" class="play-img">
        <!-- play text -->
        <div class="play-text">
            <h2>${data.movie.title}</h2>
            <!-- ratings -->
            <div class="raiting">
                <i class='bx bxs-star'></i>
                <i class='bx bxs-star'></i>
                <i class='bx bxs-star'></i>
                <i class='bx bxs-star'></i>
                <i class='bx bxs-star-half'></i>
            </div>
            <!-- tags -->
            <div class="tags">
                <span>${data.movie.genre}</span>
            </div>
            <!-- trailer button -->
            <a href="#" class="watch-btn">
                <i class='bx bx-right-arrow'></i>
                <span>Watch the trailer</span>
            </a>
        </div>
        <!-- play btn -->
        <i class='bx bx-right-arrow play-movie'></i>

        <!-- video container -->
        <div class="video-container">
            <!-- video box -->
            <div class="video-box">
                <video id="myvideo" src=${data.movie.url} autoplay controls></video>
                <!-- close video icon -->
                <i class='bx bx-x close-video' ></i>
            </div>
        </div>`;

		const aboutMovie = document.querySelector(".about-movie");
		aboutMovie.innerHTML = `
        <h2>${data.movie.title}</h2>
        <p>${data.movie.description}</p>
        <!-- data.movie cast -->
        <h2 class="cast-heading">${data.movie.title}'s Cast</h2>
        <div class="cast">
            <div class="cast-box">
                <img alt="" class="cast-img">
                <span class="cast-title">Dwayne Johnson</span>
            </div>
            <div class="cast-box">
                <img alt="" class="cast-img">
                <span class="cast-title">Karen Gillan</span>
            </div>
            <div class="cast-box">
                <img alt="" class="cast-img">
                <span class="cast-title">Kevin Hart</span>
            </div>
            <div class="cast-box">
                <img alt="" class="cast-img">
                <span class="cast-title">Nick Jonas</span>
            </div>
            <div class="cast-box">
                <img alt="" class="cast-img">
                <span class="cast-title">Alex Wolff</span>
            </div>
            <div class="cast-box">
                <img alt="" class="cast-img">
                <span class="cast-title">Madison Iseman</span>
            </div>  
        </div>
        `;
			
        const playButton = document.querySelector('.play-movie');
                        const videoContainer = document.querySelector('.video-container');
                        const closeVideoButton = document.querySelector('.close-video');

                        playButton.addEventListener('click', () => {
                            videoContainer.style.display = "flex";
                        });

                        closeVideoButton.addEventListener('click', () => {
                            videoContainer.style.display = "none";
                        });
    })
						.catch((error) =>
							console.error(
								"Error fetching data.movie details:",
								error
							)
						);
				} else {
					console.error("No data.movie ID found in URL");
				}
			});
		</script>
	</body>
</html>
